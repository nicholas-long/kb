# HTTP
- everything from the everything list (including web server version)
- robots.txt
- nikto
- busting
  - copy up busting to try list, run through it for paths, add
  - even if you identify CMS and version, find exposed files
  - view source of files found
  - fuzz files found for backups https://github.com/olemoudi/backup-fuzzer
  - db backups /usr/share/seclists/Discovery/Web-Content/Common-DB-Backups.txt
- manual inspection (view source)
  - see if the website content plainly discloses anything useful
- LFI or dir traversal
  - jhaddix
  - graceful security
  - logs or writable files to poison for LFI
  - check for Remote File Inclusion (rare)
  - everything from "LFI procedure"
  - list / enumerate running processes using proc pseudo files
  - check user input just like injections (could be passed as filenames or to commands)
  - ssh keys for usernames (linux and windows)
  - sensitive files list
  - open directories as files - see if directory listing supported (rare?)
- file upload
  - bypassing extension filtering
    - php: php4, php5, php?, phps, phtml, phar
- vhost enumeration
  - hostnames from nmap output
  - brute force vhost subdomains
- found CMS
  - try all enumeration options for tools specific to web app
    - wordpress -> wpscan initial, enumerate all plugins, bruteforce
    - drupal / silverstripe -> droopescan
  - check plugin versions for vulns exploit-db AND google
  - compromised CMS -> everything from "compromised CMS login" list
- API
  - docs/openapi.json
  - enumerate resources and endpoints to interact with them
  - enumerate parameters for endpoints - arjun
  - restful methods GET POST PUT DELETE
  - mass assignment - inject parameter on endpoints that are intended to update different fields
    - try parameter pollution
    - including extra parameters
    - type juggling
  - parameter or URL REST endpoint parameter directory traversal
  - everything from "API enumeration and bug hunting workflow"
  - everything from "OWASP top 10 api bugs"
- found login form
  - default creds
  - sqli
    - sqli filtering
  - SSTI
  - authentication bypass
    - wildcards
  - reset password
  - error message username enumeration
    - forgot password forms - applies as well
    - create user form if there is an error when user ID already exists
  - register account to find authenticated endpoints
  - brute forcing
  - xsrf
    - add self as admin
  - session attacks
    - steal session id, maybe XSS
    - clickjacking (if no X frame options set )
- fuzz all dynamic content
  - type juggling http post data
    - change content type to JSON and try different types for params
      - target things that might be compared with `==` and try changing them to `true`
    - brackets -> arrays
  - parameters
  - REST APIs -> get params and url params
  - IDs -> IDOR
  - fuzz hidden parameters, wordlist seclists/Discovery/Web-Content/burp-parameter-names.txt
  - fuzz with different HTTP methods (ex: POST might work and accept GET params)
  - fuzz headers and cookies if their values appear on page
    - fuzz special chars
    - payload tests
  - generated content like reports, emails, or logs
  - injection #injection
    - SQLi
      - no sqlmap -> wfuzz with wordlists in /usr/share/seclists/Fuzzing/SQLi/
      - dump data and try everything from "got access to database" list
    - SSTI
    - LDAP injection
    - NoSQL injection
    - XML
      - XXE xml external entity
      - XPath injection
    - XSS - dalfox
    - log4j log4shell injection - test every field, parameter, and http header with payload (especially Java stack)
  - general POST message vulnerabilities
  - JSON object prototype pollution
  - fuzz all parameters as get and post with get and post http methods
- generate cewl wordlist from site
  - use for login bruteforcing, busting directories, subdomains
- IDOR
- bypassing restrictions
  - `X-Forwarded-For` header bypass
    - bypass bad IP filter
    - bypass scripts returning 403
    - bypass rate limits
  - check if validated on client side
  - Host header pollution ( try localhost )
  - change user agent
  - open redirect can bypass URL validation
  - unicode normalization (hacktricks)
- JWT JSON web tokens
- cookie deserialization
- parameter pollution
- SSRF server side request forgery
- apache delete files -> delete .htaccess and possibly see php source
- retry dirbusting with response sizes instead of hiding 404 to find weird 404 endpoints
- what is different in HTTP vs. HTTPS?
- 403 forbidden servers / vhosts -> target http config information & find out why
- apache (old versions) - searchsploit plugins versions
- webdav
  - davtest unauth
  - davtest authenticated
- username list -> fuzz home directories like `/~user`
- mention github/source control -> go look it up, find source
  - organizations -> people and their projects / commits
  - check commit history for secrets / creds
- got source code -> everything from "got source code" list

## web to try list directory busting
for each path
  - feroxbuster medium dirs with extensions and `-e` extract links
  - .git/ and .git/HEAD
  - common
  - files
    - feroxbuster with extensions -> raft-large-words and discover backups `-B` option
    - wfuzz large filename list - look at status and content length
  - directories
    - feroxbuster recursive
    - wfuzz large
    - wfuzz dir list big
/

## specific HTTP server exploit possibilities
- tomcat
  - tomcat + apache httpd proxy route -> path traversal with `/..;/` `www.vulnerable.com/lalala/..;/manager/html` `http://www.vulnerable.com/;param=value/manager/html` (hacktricks)
- nginx + another HTTP -> request smuggling

## compromised CMS login
- service versions information -> exploit db
- file uploads
- user privileges - elevate
- code execution directly
- installs
- plugins/modules/extensions/addons/themes
  - upload with malicious backdoors
  - check if any installed plugins allow upload or exec
- downgrade attack - backdoor, plugin, revert to vulnerable version
- edit some extension or functionality
  - plant executable code
- diagnostic tools -> RCE?
- schedule system level jobs
- administration
  - access to sensitive database credentials
  - backups
  - database dumps
  - modify or downgrade access control lists
  - world writable directories
- assess the functionality provided to it and seeing if we can abuse it

### CMS auth code exec / becoming web user
- drupal
  - "extend" "install new module"
  - install drupal project php https://www.drupal.org/project/php and enable the module
    - alternatively built in module `PHP Filter` allows editing php
  - content > add content > basic page
    - edit in source view and set text type at bottom to php code
- wordpress -> edit plugins or themes to install web shell

## old stuff for old servers
- shellshock - should find with nikto?

## UNCOMMON HTTP ( hacktricks )
- 2fa bypass
- abusing hop by hop headers
- bypass payment process
- cache deception
- captcha bypass
- clickjacking
- client side template injection csti
- content security policy csp bypass
- cors bypass
- crlf 0d 0a
- cross site websocket hijacking cswsh
- csrf cross site request forgery
- dangling markup html scriptless injection
- domain subdomain takeover
- email header injection
- formula injection
- h2c smuggling
- http response smuggling desync
- oauth to account takeover
- open redirect
- race condition
- rate limit bypass
- regular expression denial of service redos
- reverse tab nabbing
- unicode normalization vulnerability
- xs search
- xslt server side injection extensible stylesheet languaje transformations
- xssi cross site script inclusion

End of Web stuff
====================================================================================================

